package cn.uce.suc.common.biz;

import javax.annotation.Resource;
import javax.servlet.http.HttpServletRequest;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.AbstractJUnit4SpringContextTests;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.context.web.WebAppConfiguration;

import cn.uce.suc.common.cache.AppLoginToKenCache;
import cn.uce.suc.common.entity.LoginEntity;
import cn.uce.suc.common.interceptor.InterfaceInterceptor;
import cn.uce.suc.common.vo.MobileuserVo;

@WebAppConfiguration
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath*:spring-*.xml", "classpath*:*/spring-*.xml" })
/**
 * 
 * @Description: 拦截器测试
 * @author liwei
 * @date 2017年12月8日 下午1:22:58
 */
public class InterfaceInterceptorTest extends AbstractJUnit4SpringContextTests {
	@Resource
	InterfaceInterceptor interfaceInterceptor;
	/**
	 * token缓存
	 */
	@Resource(name = "appLoginToKenCache")
	private AppLoginToKenCache appLoginToKenCache;

	/**
	 * 
	 * @Description: token失效校验
	 * @author liwei
	 * @date 2017年12月8日 下午1:12:39
	 */
	@Test
	public void tokenValid() {
		LoginEntity loginEntity=new LoginEntity();
		MobileuserVo mobileuserVo=new MobileuserVo();
		mobileuserVo.setCertifiFlag(false);
		loginEntity.setMobileuserVo(mobileuserVo);
		loginEntity.setTokenId("hdhghBFGfg");
		appLoginToKenCache.set("18729255646", "dot", loginEntity);
		//HttpServletRequest request=this.applicationContext.;
		interfaceInterceptor.tokenCkeck(null,"18729255646", "dot", "hdhghBFGfg","app/activityAdvert");
	}
	

}
